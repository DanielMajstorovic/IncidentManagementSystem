<!-- MODERN HEADER -->
<header class="app-header">
  <div class="header-container">
    
    <!-- Logo/Brand Section -->
    <div class="brand-section">
      <div class="brand-icon">
        <i class="bi bi-shield-exclamation"></i>
      </div>
      <div class="brand-text">
        <h1 class="brand-title">Incident Management System</h1>
      </div>
    </div>

    <!-- Navigation (Optional - for future use) -->
    <nav class="main-nav d-none d-lg-flex">
      <a href="#" class="nav-link active">
        <i class="bi bi-map"></i>
        <span>Map View</span>
      </a>
      <a href="#" class="nav-link">
        <i class="bi bi-list-ul"></i>
        <span>Incidents</span>
      </a>
      <a href="#" class="nav-link">
        <i class="bi bi-bar-chart"></i>
        <span>Analytics</span>
      </a>
    </nav>

    <!-- User Section -->
    <div class="user-section">
      
      <!-- Authenticated User -->
      <div class="user-info" *ngIf="user$ | async as user; else loginBlock">
        
        <!-- User Details -->
        <div class="user-details d-none d-md-block">
          <div class="user-name">{{ user.name }}</div>
          <div class="user-role">
            <i class="bi" [class]="'bi-' + getRoleIcon(user.role)"></i>
            <span [style.color]="getRoleColor(user.role)">{{ user.role }}</span>
          </div>
        </div>

        <!-- User Avatar with Dropdown -->
        <div class="user-avatar-container" (click)="toggleMenu()">
          <div class="user-avatar" 
               [style.background-image]="user.avatar ? 'url(' + user.avatar + ')' : 'none'"
               [style.background-color]="!user.avatar ? getRoleColor(user.role) : 'transparent'">
            <span *ngIf="!user.avatar" class="avatar-initials">{{ getInitials(user.name) }}</span>
          </div>
          <div class="status-indicator online"></div>
          <i class="bi bi-chevron-down dropdown-arrow" 
             [class.rotated]="isMenuOpen"></i>
        </div>

        <!-- Dropdown Menu -->
        <div class="user-dropdown" [class.show]="isMenuOpen">
          <div class="dropdown-header">
            <div class="dropdown-user-info">
              <div class="dropdown-name">{{ user.name }}</div>
              <div class="dropdown-email">{{ user.email }}</div>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-items">
            <button class="dropdown-item logout-item" (click)="logout()">
              <i class="bi bi-box-arrow-right"></i>
              <span>Sign Out</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Login Button -->
      <ng-template #loginBlock>
        <button class="login-btn" (click)="loginWithGoogle()">
          <i class="bi bi-google"></i>
          <span>Sign in with Google</span>
        </button>
      </ng-template>

    </div>
  </div>

  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle d-lg-none" (click)="toggleMenu()">
    <i class="bi bi-list"></i>
  </button>
</header>

<!-- MAIN CONTENT WRAPPER -->
<main class="main-content">
  <router-outlet></router-outlet>
</main>

<!-- Overlay for dropdown -->
<div class="dropdown-overlay" 
     [class.show]="isMenuOpen" 
     (click)="isMenuOpen = false"></div>
